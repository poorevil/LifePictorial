<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>画报-淘客链接管理</title>

<!-- 最新 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">
<style type="text/css" media="screen">
	body {
        background-color: #f1f1f1;
        margin-top: 20px;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        padding-top: 70px;
      }

    .center_body{

    }

      .footer {
      	margin-top: 29px;
		padding-top: 19px;
		color: #777;
		border-top: 1px solid #e5e5e5;
	  }

	 
</style>

</head>
<body>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
		<ol class="breadcrumb">
		  <li><a href="#">Home</a></li>
		  <li><a href="#">Library</a></li>
		  <li class="active">Data</li>
		</ol>
	</nav>
	<div class="container">
    	<div class="row">
    		<div class="col-md-3">
				<div class="list-group" style="width:200px" data-spy="affix" data-offset-top="0" role="complementary" >
				  <a href="/admin/taokeitem_manager?appcode={{ appcode }}" class="list-group-item">
				  	管理列表
				  </a>
				  <a href="#" class="list-group-item active">添加链接</a>
				  <a href="/admin/taokeitem_manager_sort?appcode={{ appcode }}" class="list-group-item">排序</a>
				</div>
			</div>
			<div class="col-md-9" role="main">
				<div class="center_body">
					<form action="/admin/taokeitem_manager_add_item?appcode={{appcode}}" name="taokeItemAddForm" id="taokeItemAddForm" method="post" class="form-horizontal" role="form">
						{{ form.non_field_errors }}
						<div class="form-group">
							{{ form.num_iid.errors }}
							<label for="num_iid" class="col-sm-2 col-md-2 control-label">{{ form.num_iid.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.num_iid.html_name }}" name="{{ form.num_iid.html_name }}" placeholder="{{ form.num_iid.label }}"/>
							</div>
							<button type="button" id="fetchBtn" class="btn btn-link">抓取</button>
						</div>

						<div class="form-group">
							{{ form.pic_path.errors }}
							<label for="pic_path" class="col-sm-2 col-md-2 control-label">{{ form.pic_path.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.pic_path.html_name }}" name="{{ form.pic_path.html_name }}" placeholder="{{ form.pic_path.label }}"/>
							</div>
						</div>

						<div class="form-group">
							{{ form.taoke_title.errors }}
							<label for="taoke_title" class="col-sm-2 col-md-2 control-label control-label">{{ form.taoke_title.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.taoke_title.html_name }}" name="{{ form.taoke_title.html_name }}" placeholder="{{ form.taoke_title.label }}"/>
							</div>
						</div>

						<div class="form-group">
							{{ form.taoke_price.errors }}
							<label for="{{ form.taoke_price.html_name }}" class="col-sm-2 col-md-2 control-label control-label">{{ form.taoke_price.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.taoke_price.html_name }}" name="{{ form.taoke_price.html_name }}" placeholder="{{ form.taoke_price.label }}"/>
							</div>
						</div>

						<div class="form-group">
							{{ form.pic_desc.errors }}
							<label for="{{ form.pic_desc.html_name }}" class="col-sm-2 col-md-2 control-label control-label">{{ form.pic_desc.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.pic_desc.html_name }}" name="{{ form.pic_desc.html_name }}" placeholder="{{ form.pic_desc.label }}"/>
							</div>
						</div>

						<div class="form-group">
							{{ form.taoke_url.errors }}
							<label for="taoke_url" class="col-sm-2 col-md-2 control-label control-label">{{ form.taoke_url.label }}</label>
							<div class="col-md-4 col-sm-4">
								<input type="text" class="form-control" id="{{ form.taoke_url.html_name }}" name="{{ form.taoke_url.html_name }}" placeholder="{{ form.taoke_url.label }}"/>
							</div>
						</div>

						<div class="form-group">
							{{ form.categoary_id.errors }}
							<label for="categoary_id" class="col-sm-2 col-md-2 control-label control-label">{{ form.categoary_id.label }}</label>
							<div class="col-md-4 col-sm-4">
								<!-- <input type="text" class="form-control" id="categoary_id" name="categoary_id" placeholder="所属分类"/> -->
								{{ form.categoary_id }}
							</div>
						</div>
						

						<div class="col-md-offset-4 col-sm-offset-4">
							<button type="submit" id="submitBtn" class="btn btn-primary">保存</button>
							<button type="reset" class="btn btn-link">重置</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
	<script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
	<script type="text/javascript">

	$(document).ready(function(){
		//绑定按钮点击事件
		$("#fetchBtn").click(function(){
			var _nAjaxTimeout = 5 * 10000;

			$.ajax({
				type: "GET",
				url:"/admin/taokeitem_manager_fetch_item_detail/"+$('#num_iid').val()+"/",
				dataType: "json",
				cache: false,
				timeout: _nAjaxTimeout,
				success: function(data, textStatus, jqXHR) {
					// alert(eval(data["result_code"])+data["msg"]);
					// alert(textStatus);
					// alert(eval(jqXHR));

					switch(data["result_code"]){
						case 208://get result！！
							// alert("result_code: "+eval(data["result_code"])+"     msg: "+data["msg"]);
							var total_results = data["tbk_items_detail_get_response"]["total_results"];
							if(total_results > 0){
								var tbk_item = data["tbk_items_detail_get_response"]["tbk_items"]["tbk_item"][0];
								$("#taoke_title").val(tbk_item["title"]);
								$("#pic_path").val(tbk_item["pic_url"]);
								$("#taoke_price").val(tbk_item["price"]);
							}

							break;
						
						default:
							alert("result_code: "+eval(data["result_code"])+"     msg: 抓取失败");
							break;
					}
				},
				error: function(jqXHR, textStatus, errorThrown) {
					alert(textStatus);
					
				}
			});
		});
	});

	</script>
	
</body>
</html>
